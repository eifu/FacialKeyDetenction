<!DOCTYPE html>
<meta charset="utf-8">
<head>
<script type="text/javascript" src="face.js"></script>
<style type="text/css">
            
#g1 {
width: 200px;
height: 200px;
}

#g2 {
width: 200px;
height: 200px;
}

.division{
  width:50%;
  height:100px;
  float:left;
}
.no-division{
  width:100%;
  height:100px;
  float:left;
}
</style>

</head>
<body>  
<script src="http://d3js.org/d3.v4.min.js"></script>
<div class="division">
  
  <p id="g1"></p>
</div>
<div class="division">
  <p id="g2"></p>
</div>
<div class="no-division">
  
</div>

<script>
var labels = ["left_eye_center", "right_eye_center", 
          "left_eye_inner_corner", "left_eye_outer_corner", 
          "right_eye_inner_corner", "right_eye_outer_corner", 
          "left_eyebrow_inner_end", "left_eyebrow_outer_end", 
          "right_eyebrow_inner_end", "right_eyebrow_outer_end", 
          "nose_tip", "mouth_left_corner", "mouth_right_corner", 
          "mouth_center_top_lip", "mouth_center_bottom_lip"];

var index1 = 0;
var N = 2140;

var width = 200;
var height = 200;



var g1_svg = d3.select("#g1").append("svg")
    .attr("id", "g1_svg")
    .attr("width", width)
    .attr("height", height)
    .append("g");


g1_svg.append("g")
.attr("id", "g1_layer1");
g1_svg.append("g")
.attr("id", "g1_layer2");

face(7, "g1_layer1");

facialKeys(index1, "g1_layer2")


index1 = index1 + 1;
var g2_svg = d3.select("#g2").append("svg")
    .attr("id", "g2_svg")
    .attr("width", width)
    .attr("height", height)
    .append("g");


g2_svg.append("g")
.attr("id", "g2_layer1");

g2_svg.append("g")
.attr("id", "g2_layer2");

face(7, "g2_layer1");

facialKeys(index1, "g2_layer2")

var g3_svg = d3.select("#g2").append("svg")
    .attr("id", "g3_svg")
    .attr("width", 400)
    .attr("height", 400)
    .append("g");

var h = 30, w = 30;
var colorScale = d3.scaleLinear()
.domain([-1, -0.75, -0.5, -0.25, 0, 0.25, 0.5, 0.75, 1])
.range(["#3182bd", "#6baed6", "#6baed6", "#6baed6","white", "#6baed6","#6baed6", "#fd8d3c","#e6550d" ])
d3.csv("corr.csv", function(error, data){
  var data_foruse=[];
  data.forEach(function(d){
    var x = d[""];
    delete d[""];
    for (p in d){
      data_foruse.push({
        x:x,
        y:p,
        value: +d[p]  
      })
    }
  });

  d3.select("g3_svg").selectAll(".heatmap")
  .data(data_foruse)
  .enter().append("rect")
  .attr("x", function(d){return labels.indexof(d.x) * w})
  .attr("y", function(d) { return labels.indexOf(d.y) * h; })
  .attr("width", function(d) { return w; })
  .attr("height", function(d) { return h; })
  .style("fill", function(d) { return colorScale(d.value); });


});

</script>
</body>